# Single Service Render Blueprint for StudyMateAI
# This deploys both frontend and backend as one unified application

services:
  # Unified Service - React Frontend + Spring Boot Backend
  - type: web
    name: studymate-app
    runtime: docker
    plan: starter
    dockerfilePath: ./Dockerfile
    env: production
    buildCommand: ""
    startCommand: ""
    healthCheckPath: /api/actuator/health
    autoDeploy: true
    envVars:
      - key: PORT
        value: 8080
      - key: SPRING_PROFILES_ACTIVE
        value: production
      - key: JAVA_OPTS
        value: "-XX:+UseContainerSupport -XX:MaxRAMPercentage=75.0 -XX:+UseG1GC"
      - key: SPRING_DATASOURCE_URL
        value: "jdbc:postgresql://aws-0-ap-south-1.pooler.supabase.com:5432/postgres"
      - key: SPRING_DATASOURCE_USERNAME
        value: "postgres.vfhswjfjwqjmpcxjgedc"
      - key: SPRING_DATASOURCE_PASSWORD
        value: "ahtasham2105067"
      - key: JWT_SECRET
        generateValue: true
      - key: JWT_EXPIRATION
        value: "86400000"
      - key: GEMINI_API_KEY
        value: "AIzaSyA2DsN6bTwwuySdLO-VkPwuaKBW19ShbSk"
      - key: GEMINI_API_URL
        value: "https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent"
      - key: SPRING_JPA_HIBERNATE_DDL_AUTO
        value: "update"
      - key: SPRING_JPA_SHOW_SQL
        value: "false"
      - key: CORS_ALLOWED_ORIGINS
        value: "*"
      - key: FILE_UPLOAD_DIR
        value: "/app/uploads"
      - key: MAX_FILE_SIZE
        value: "50MB"
      - key: MAX_REQUEST_SIZE
        value: "50MB"
